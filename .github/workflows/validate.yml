name: Validate Workflows

on:
  push:
    paths:
      - '.github/workflows/**'
  pull_request:
    paths:
      - '.github/workflows/**'

jobs:
  validate:
    name: Validate Workflow Syntax
    runs-on: ubuntu-latest
    timeout-minutes: 5

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Validate workflow files
        run: |
          echo "ğŸ” Validating GitHub Actions workflow files..."
          
          # ì›Œí¬í”Œë¡œìš° íŒŒì¼ë“¤ì´ ì˜¬ë°”ë¥¸ YAML í˜•ì‹ì¸ì§€ í™•ì¸
          for file in .github/workflows/*.yml .github/workflows/*.yaml; do
            if [ -f "$file" ]; then
              echo "Checking $file..."
              # ê¸°ë³¸ YAML ë¬¸ë²• ì²´í¬ (pythonì´ ê¸°ë³¸ ì„¤ì¹˜ë˜ì–´ ìˆìŒ)
              python3 -c "
          import yaml
          import sys
          try:
              with open('$file', 'r') as f:
                  yaml.safe_load(f)
              print('âœ… $file is valid YAML')
          except yaml.YAMLError as e:
              print('âŒ $file has YAML syntax error:', e)
              sys.exit(1)
          except Exception as e:
              print('âŒ Error reading $file:', e)
              sys.exit(1)
              "
            fi
          done
          
          echo "âœ… All workflow files are valid!"

      - name: Check for common issues
        run: |
          echo "ğŸ” Checking for common workflow issues..."
          
          # ì‚¬ìš©ëœ ì•¡ì…˜ë“¤ì˜ ë²„ì „ì´ ìµœì‹ ì¸ì§€ í™•ì¸
          echo "ğŸ“‹ Actions used in workflows:"
          grep -h "uses:" .github/workflows/*.yml | sort | uniq | sed 's/^[[:space:]]*/- /'
          
          echo ""
          echo "ğŸ’¡ Consider keeping actions up to date for security and features." 